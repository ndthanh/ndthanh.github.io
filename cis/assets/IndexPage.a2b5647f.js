import{u as E,a as S,Q as x,b as p,c as N,V as O}from"./index.1441a30a.js";import{m as P}from"./use-dark.fa1f8c5e.js";import{r as t,o as V,G as f,O as T,S as i,N as C,W as d,I,J as h,L as w,K as u,Y as Q,M as k,Z as q}from"./index.b53888a7.js";const B={class:"q-pa-md"},H={class:"q-gutter-md",style:{"max-width":"600px"}},L=i("br",null,null,-1),Y=i("br",null,null,-1),j={__name:"IndexPage",setup(A){const s=t(""),l=t(""),R=t(""),n=t(!1),r=t(""),c=t(""),m=t(""),g=Q();q();const{isOnline:v}=E();S("history"),V(()=>{n.value=!0,m.value=g.query.uuid;const a=o=>{r.value=o.coords.latitude,c.value=o.coords.longitude,console.log(r.value),console.log(r.value),n.value=!1},e=o=>{r.value="device_not_supported",c.value="device_not_supported",n.value=!1};navigator.geolocation.getCurrentPosition(a,e)});function y(a){l.value=a}async function _(a){try{await a}catch(e){e.name==="NotAllowedError"?e.value="ERROR: you need to grant camera access permission":e.name==="NotFoundError"?e.value="ERROR: no camera on this device":e.name==="NotSupportedError"?e.value="ERROR: secure context required (HTTPS, localhost)":e.name==="NotReadableError"?e.value="ERROR: is the camera already in use?":e.name==="OverconstrainedError"?e.value="ERROR: installed cameras are not suitable":e.name==="StreamApiNotSupportedError"?e.value="ERROR: Stream API is not supported in this browser":e.name==="InsecureContextError"?e.value="ERROR: Camera access is only permitted in secure context. Use HTTPS or localhost rather than HTTP.":e.value=`ERROR: Camera error (${e.name})`}}function b(){n.value=!0;const a={method:"POST",contentType:"application/json",body:JSON.stringify({consumerphone:s.value,dealercode:l.value,uuid:m.value,latitude:r.value,longitude:c.value})};fetch("https://script.google.com/macros/s/AKfycbyihlJ_YdCjXHcOmLuGXvpInPIPmvd8pvElS2CwP-N8Ybr-1zprMeiVLYW9nshHqm1p/exec",a).then(e=>e.json()).then(e=>{alert(e.message),s.value="",l.value="",n.value=!1})}return(a,e)=>(f(),T("div",B,[i("pre",null,C(R.value),1),d(v)?w("",!0):(f(),I(x,{key:0,"inline-actions":"",class:"text-white bg-red"},{default:h(()=>[k(" You have lost connection to the internet. This app is offline. ")]),_:1})),i("div",H,[u(p,{modelValue:s.value,"onUpdate:modelValue":e[0]||(e[0]=o=>s.value=o),type:"tel",label:"Phone Number"},null,8,["modelValue"]),u(p,{readonly:"",modelValue:l.value,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value=o),type:"text",label:"Please scan your QR"},null,8,["modelValue"])]),L,u(d(O.exports.QrcodeStream),{onDecode:y,onInit:_}),Y,u(N,{position:"bottom-right",offset:[18,18]},{default:h(()=>[u(P,{onClick:b,fab:"",push:"",color:"primary",loading:n.value,disable:s.value.length===0||l.value.length===0||!d(v),label:"Send data"},null,8,["loading","disable"])]),_:1})]))}};export{j as default};
